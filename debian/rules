#!/usr/bin/make -f
# -*- makefile -*-

include /usr/share/dpkg/default.mk

export DH_VERBOSE = 1
export DEB_BUILD_MAINT_OPTIONS = hardening=+all

VERSION ?= $(shell dpkg-parsechangelog | sed -rne 's/^Version: ([0-9.]+).*$$/\1/p')

%:
	dh $@ --with dkms

override_dh_auto_install:
	dh_install -prtw89-dkms *.c *.h *.bin *.md 					usr/src/rtw89-$(VERSION)
	dh_install -prtw89-dkms LICENSE 					        usr/src/rtw89-$(VERSION)
	dh_install -prtw89-dkms Makefile 					        usr/src/rtw89-$(VERSION)
	dh_install -prtw89-dkms debian/rtw89-dkms-blacklist.conf    etc/modprobe.d/
	dh_install -prtw89-dkms rtw8852a_fw.bin                       lib/firmware/rtw89/
	dh_install -prtw89-dkms rtl8852au_fw.bin rtl8852au_config.bin lib/firmware/rtl_bt/


override_dh_dkms:
	dh_dkms -p rtw89-dkms -V $(VERSION) -- debian/dkms.conf

override_dh_auto_build:
	:
